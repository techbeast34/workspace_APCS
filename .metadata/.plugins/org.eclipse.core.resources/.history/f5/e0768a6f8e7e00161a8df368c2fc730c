import java.io.File;
import java.io.FileNotFoundException;
import java.lang.reflect.Array;
import java.util.Scanner;

public class ZipcodeToBarcode {
	static final String[] encodedBarcode = { "||:::", // 0
			":::||", // 1
			"::|:|", // 2
			"::||:", // 3
			":|::|", // 4
			":|:|:", // 5
			":||::", // 6
			"|:::|", // 7
			"|::|:", // 8
			"|:|::" }; // 9

	public static void main(String[] args) throws FileNotFoundException {
		File zipCodeFile = new File("ZipCodes.txt");
		File cityFile = new File("ZipCodesCity.txt");
		File barcodeFile = new File("ZipBarCodes.txt");
		Scanner zipcodeFileScanner = new Scanner(zipCodeFile);
		Scanner cityFileScanner = new Scanner(cityFile);
		Scanner barcodeScanner = new Scanner(barcodeFile);
		String[] barcodeArray = new String[6];
		String[] zipCode = new String[6];
		String barcode = "";
		while (zipcodeFileScanner.hasNext()) {
			zipCode = readZipCode(zipcodeFileScanner);
			barcodeArray = encodeZipCode(zipcodeFileScanner, zipCode);
			printBarCode(barcodeArray, zipCode, cityFileScanner, cityFile);
			cityFileScanner = new Scanner(cityFile);
		}
		zipCode = new String[6];
		cityFileScanner = new Scanner(cityFile);
		while(barcodeScanner.hasNext()){
			barcode = barcodeScanner.nextLine();
			zipCode = decodeBarcode(barcode);
			printZipCode(zipCode, barcode, cityFileScanner);
			
		}
	}

	private static void printZipCode(String[] zipCode, String barcode, Scanner cityFileScanner) {
		int checkTotal = 0;
		int checkDigit = Integer.parseInt(zipCode[zipCode.length - 1]);
		
		
		for(int i = 0; i < 5; i++){
			checkTotal += Integer.parseInt(zipCode[i]);
			
		}
		
		if(checkDigit == 10 - (checkTotal % 10) || (checkTotal % 10 == 0 && checkDigit == 0))
		{
			System.out.print(barcode + "------->");
			for(int i = 0; i < zipCode.length - 1; i++)
			{
				System.out.print(zipCode[i]);
			}
			System.out.println();
		}
		else 
		{
			System.out.print(barcode + "------->");
			System.err.println("ERROR - Invalid Check Digit!");
		}

	}

	private static String[] decodeBarcode(String barcode) {
		char[] barcodeArray = barcode.toCharArray();
		String barcodeBit = "";
		String[] zipCode = new String[6];
		int count = 0;
		
		for(int i = 0; i < barcodeArray.length; i++){
			if(i != 0 || i != barcodeArray.length){
				barcodeBit += barcodeArray[i];
				System.out.println("Reached");
				if(i % 5 == 0){
					System.out.println("Reached in");
					if(count > 6) {
						count = 0;
					}
					for(int d = 0; d < encodedBarcode.length; d++){
						if(encodedBarcode[d].equals(barcodeBit)){
							
							zipCode[count] = d + "";
						}
					}
				}
			}
		}
		return zipCode;
	}

	private static void printBarCode(String[] barcode, String[] zipCode, Scanner scanner, File cityFile)
			throws FileNotFoundException {
		String zipcode = "";
		String currentLine = "";
		String city = "";
		for (int i = 0; i < zipCode.length; i++) {
			zipcode += zipCode[i];
		}

		while (scanner.hasNext()) {
			currentLine = scanner.nextLine();
			if (currentLine.contains(zipcode)) {
				city += currentLine + "\n";
			}
		}
		System.out.println(city);
		System.out.print("\t Readable Barcode");
		System.out.print(" | ");
		for (int i = 0; i < barcode.length; i++) {
			System.out.print(" " + barcode[i]);
		}
		System.out.print(" |");
		System.out.println();
		System.out.print("     \t Postal Barcode ");
		System.out.print("|");
		for (int i = 0; i < barcode.length; i++) {
			System.out.print(barcode[i]);
		}
		System.out.print("|");
		System.out.println();
		System.out.println();
	}

	private static String[] encodeZipCode(Scanner scanner, String[] zipCode) {

		String[] barCode = new String[6];
		int total = 0;
		int checkDigit = 0;
		for (int i = 0; i < 5; i++) {
			total += Integer.parseInt(zipCode[i]);
		}
		checkDigit = 10 - (total % 10);
		if (checkDigit == 10) {
			checkDigit = 0;
		}
		for (int i = 0; i < zipCode.length; i++) {
			barCode[i] = encodedBarcode[Integer.parseInt(zipCode[i])];
		}
		barCode[5] = encodedBarcode[checkDigit];
		return barCode;
	}

	private static String[] readZipCode(Scanner scanner) {
		int total = 0;
		int checkDigit = 0;
		String zipCode = scanner.next();
		String[] zipCodeArray = new String[5];
		for (int i = 0; i < zipCodeArray.length; i++) {
			zipCodeArray[i] = zipCode.charAt(i) + "";
		}
		return zipCodeArray;
	}

}
